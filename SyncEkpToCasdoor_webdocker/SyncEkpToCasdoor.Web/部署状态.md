# éƒ¨ç½²å®Œæˆæƒ…å†µ

## âœ… å·²å®Œæˆçš„æ­¥éª¤

### 1. âœ“ æ–‡ä»¶å‡†å¤‡
- âœ“ åˆ›å»º Dockerfile
- âœ“ åˆ›å»º docker-compose.yml  
- âœ“ åˆ›å»º appsettings.Production.json
- âœ“ åˆ›å»ºéƒ¨ç½²åŒ…: deploy_20251031_165043.zip (1.5MB)

### 2. âœ“ æ–‡ä»¶ä¸Šä¼ 
- âœ“ å·²æˆåŠŸä¸Šä¼ åˆ°æœåŠ¡å™¨: /tmp/deploy_20251031_165043.zip
- âœ“ å·²è§£å‹åˆ°: /opt/syncekp-web/

### 3. âœ“ Docker å‡†å¤‡
- âœ“ åœæ­¢å¹¶åˆ é™¤æ—§å®¹å™¨
- â³ Docker é•œåƒæ­£åœ¨æ„å»ºä¸­...

## ğŸ”„ å½“å‰çŠ¶æ€

Docker æ­£åœ¨ä¸‹è½½ .NET 9.0 SDK åŸºç¡€é•œåƒå¹¶æ„å»ºåº”ç”¨ç¨‹åºã€‚

è¿™ä¸ªè¿‡ç¨‹éœ€è¦ **5-10 åˆ†é’Ÿ**ï¼ˆé¦–æ¬¡æ„å»ºï¼‰ï¼Œå› ä¸ºéœ€è¦ï¼š
1. ä¸‹è½½ .NET 9.0 SDK é•œåƒï¼ˆçº¦ 700MBï¼‰
2. ä¸‹è½½ .NET 9.0 è¿è¡Œæ—¶é•œåƒï¼ˆçº¦ 200MBï¼‰
3. è¿˜åŸ NuGet åŒ…
4. ç¼–è¯‘åº”ç”¨ç¨‹åº

## ğŸ“‹ æ¥ä¸‹æ¥éœ€è¦æ‰‹åŠ¨å®Œæˆ

ç”±äº Windows PowerShell SSH å¯†ç è®¤è¯çš„é™åˆ¶ï¼Œè¯·æŒ‰ä»¥ä¸‹æ­¥éª¤å®Œæˆéƒ¨ç½²ï¼š

### æ–¹æ³•1: ä½¿ç”¨ PowerShell SSHï¼ˆæ¨èï¼‰

æ‰“å¼€ä¸€ä¸ªæ–°çš„ PowerShell çª—å£ï¼Œæ‰§è¡Œï¼š

```powershell
ssh root@172.16.10.110
```

è¾“å…¥å¯†ç : `fwater@163.com`

è¿æ¥æˆåŠŸåï¼Œå¤åˆ¶ç²˜è´´ä»¥ä¸‹å‘½ä»¤ï¼š

```bash
cd /opt/syncekp-web

# ç­‰å¾…æ„å»ºå®Œæˆï¼ˆå¦‚æœè¿˜åœ¨æ„å»ºä¸­ï¼‰
docker compose build

# å¯åŠ¨å®¹å™¨
docker compose up -d

# ç­‰å¾…å¯åŠ¨
sleep 5

# æ£€æŸ¥çŠ¶æ€
docker ps | grep syncekp

# æŸ¥çœ‹æ—¥å¿—
docker logs --tail 30 syncekp-casdoor-web
```

### æ–¹æ³•2: ä½¿ç”¨ PuTTY

1. æ‰“å¼€ PuTTY
2. è¾“å…¥ä¸»æœº: `172.16.10.110`
3. ç‚¹å‡» Open
4. è¾“å…¥ç”¨æˆ·å: `root`
5. è¾“å…¥å¯†ç : `fwater@163.com`
6. æ‰§è¡Œä¸Šé¢ç›¸åŒçš„å‘½ä»¤

### æ–¹æ³•3: ç­‰å¾…è‡ªåŠ¨å®Œæˆ

å¦‚æœä¹‹å‰çš„ `docker compose build` å‘½ä»¤è¿˜åœ¨è¿è¡Œï¼Œå®ƒä¼šè‡ªåŠ¨å®Œæˆæ„å»ºã€‚
æ„å»ºå®Œæˆåï¼Œä½ åªéœ€è¦æ‰§è¡Œï¼š

```bash
ssh root@172.16.10.110
cd /opt/syncekp-web
docker compose up -d
docker ps | grep syncekp
```

## âœ… éªŒè¯éƒ¨ç½²

éƒ¨ç½²å®Œæˆåï¼Œåœ¨æµè§ˆå™¨ä¸­è®¿é—®ï¼š

- **å†…ç½‘æµ‹è¯•**: http://172.16.10.110:9000
- **å¤–ç½‘è®¿é—®**: http://syn-ekp.fzcsps.com:9000

ä½ åº”è¯¥èƒ½çœ‹åˆ°ç™»å½•é¡µé¢ã€‚

## ğŸ“Š æŸ¥çœ‹çŠ¶æ€

```bash
# æŸ¥çœ‹å®¹å™¨çŠ¶æ€
docker ps | grep syncekp

# æŸ¥çœ‹å®æ—¶æ—¥å¿—
docker logs -f syncekp-casdoor-web

# æŸ¥çœ‹æœ€è¿‘50è¡Œæ—¥å¿—
docker logs --tail 50 syncekp-casdoor-web

# æŸ¥çœ‹å®¹å™¨èµ„æºä½¿ç”¨
docker stats syncekp-casdoor-web

# è¿›å…¥å®¹å™¨å†…éƒ¨
docker exec -it syncekp-casdoor-web /bin/bash
```

## ğŸ”§ ç®¡ç†å‘½ä»¤

```bash
# åœæ­¢å®¹å™¨
docker stop syncekp-casdoor-web

# å¯åŠ¨å®¹å™¨
docker start syncekp-casdoor-web

# é‡å¯å®¹å™¨
docker restart syncekp-casdoor-web

# åˆ é™¤å®¹å™¨
docker rm -f syncekp-casdoor-web

# é‡æ–°éƒ¨ç½²
cd /opt/syncekp-web
docker compose down
docker compose build --no-cache
docker compose up -d
```

## ğŸ› æ•…éšœæ’æŸ¥

### å¦‚æœå®¹å™¨æ— æ³•å¯åŠ¨

1. æŸ¥çœ‹æ—¥å¿—:
```bash
docker logs syncekp-casdoor-web
```

2. æ£€æŸ¥ç«¯å£å ç”¨:
```bash
netstat -tulpn | grep 9000
```

3. æ£€æŸ¥ Docker ç½‘ç»œ:
```bash
docker network ls
docker network inspect syncekp-web_app-network
```

### å¦‚æœæ— æ³•è®¿é—®

1. æ£€æŸ¥é˜²ç«å¢™:
```bash
firewall-cmd --list-ports
firewall-cmd --add-port=9000/tcp --permanent
firewall-cmd --reload
```

2. æ£€æŸ¥ SELinux (å¦‚æœå¯ç”¨):
```bash
getenforce
setenforce 0  # ä¸´æ—¶ç¦ç”¨æµ‹è¯•
```

3. æµ‹è¯•å®¹å™¨å†…éƒ¨è®¿é—®:
```bash
docker exec syncekp-casdoor-web curl http://localhost:9000/login
```

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æä¾›ï¼š

1. **å®¹å™¨æ—¥å¿—**:
```bash
docker logs syncekp-casdoor-web > /tmp/container.log
cat /tmp/container.log
```

2. **å®¹å™¨çŠ¶æ€**:
```bash
docker ps -a | grep syncekp
docker inspect syncekp-casdoor-web
```

3. **ç«¯å£çŠ¶æ€**:
```bash
netstat -tulpn | grep 9000
```

---

## ğŸ“ é…ç½®ä¿¡æ¯

- **æœåŠ¡å™¨IP**: 172.16.10.110
- **éƒ¨ç½²è·¯å¾„**: /opt/syncekp-web
- **å®¹å™¨å**: syncekp-casdoor-web
- **ç«¯å£**: 9000
- **åŸŸå**: syn-ekp.fzcsps.com:9000
- **OAuthå›è°ƒ**: http://syn-ekp.fzcsps.com:9000/callback
- **Casdoor SSO**: http://sso.fzcsps.com

## ğŸ‰ å®Œæˆï¼

ä¸€æ—¦å®¹å™¨æˆåŠŸå¯åŠ¨ï¼Œä½ å°±å¯ä»¥ï¼š

1. è®¿é—® http://syn-ekp.fzcsps.com:9000
2. ç‚¹å‡»"é€šè¿‡ Casdoor ç™»å½•"
3. ä½¿ç”¨ built-in ç»„ç»‡çš„ç”¨æˆ·ç™»å½•
4. å¼€å§‹ä½¿ç”¨ç³»ç»Ÿ

**æ‰€æœ‰æ–‡ä»¶å·²ä¸Šä¼ å¹¶å‡†å¤‡å°±ç»ªï¼Œåªéœ€ç­‰å¾… Docker æ„å»ºå®Œæˆå¹¶å¯åŠ¨å®¹å™¨ï¼**
